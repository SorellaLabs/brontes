{"expiry":1699512896,"data":[{"SourceCode":"# @version 0.2.15\r\n\"\"\"\r\n@title Voting Escrow Delegation Proxy\r\n@author Curve Finance\r\n@license MIT\r\n\"\"\"\r\n\r\nfrom vyper.interfaces import ERC20\r\n\r\n\r\ninterface VeDelegation:\r\n    def adjusted_balance_of(_account: address) -> uint256: view\r\n\r\n\r\nevent CommitAdmins:\r\n    ownership_admin: address\r\n    emergency_admin: address\r\n\r\nevent ApplyAdmins:\r\n    ownership_admin: address\r\n    emergency_admin: address\r\n\r\nevent DelegationSet:\r\n    delegation: address\r\n\r\n\r\nVOTING_ESCROW: constant(address) = 0x5f3b5DfEb7B28CDbD7FAba78963EE202a494e2A2\r\n\r\n\r\ndelegation: public(address)\r\n\r\nemergency_admin: public(address)\r\nownership_admin: public(address)\r\nfuture_emergency_admin: public(address)\r\nfuture_ownership_admin: public(address)\r\n\r\n\r\n@external\r\ndef __init__(_delegation: address, _o_admin: address, _e_admin: address):\r\n    self.delegation = _delegation\r\n\r\n    self.ownership_admin = _o_admin\r\n    self.emergency_admin = _e_admin\r\n\r\n    log DelegationSet(_delegation)\r\n\r\n\r\n@view\r\n@external\r\ndef adjusted_balance_of(_account: address) -> uint256:\r\n    \"\"\"\r\n    @notice Get the adjusted veCRV balance from the active boost delegation contract\r\n    @param _account The account to query the adjusted veCRV balance of\r\n    @return veCRV balance\r\n    \"\"\"\r\n    _delegation: address = self.delegation\r\n    if _delegation == ZERO_ADDRESS:\r\n        return ERC20(VOTING_ESCROW).balanceOf(_account)\r\n    return VeDelegation(_delegation).adjusted_balance_of(_account)\r\n\r\n\r\n@external\r\ndef kill_delegation():\r\n    \"\"\"\r\n    @notice Set delegation contract to 0x00, disabling boost delegation\r\n    @dev Callable by the emergency admin in case of an issue with the delegation logic\r\n    \"\"\"\r\n    assert msg.sender in [self.ownership_admin, self.emergency_admin]\r\n\r\n    self.delegation = ZERO_ADDRESS\r\n    log DelegationSet(ZERO_ADDRESS)\r\n\r\n\r\n@external\r\ndef set_delegation(_delegation: address):\r\n    \"\"\"\r\n    @notice Set the delegation contract\r\n    @dev Only callable by the ownership admin\r\n    @param _delegation `VotingEscrowDelegation` deployment address\r\n    \"\"\"\r\n    assert msg.sender == self.ownership_admin\r\n\r\n    # call `adjusted_balance_of` to make sure it works\r\n    VeDelegation(_delegation).adjusted_balance_of(msg.sender)\r\n\r\n    self.delegation = _delegation\r\n    log DelegationSet(_delegation)\r\n\r\n\r\n@external\r\ndef commit_set_admins(_o_admin: address, _e_admin: address):\r\n    \"\"\"\r\n    @notice Set ownership admin to `_o_admin` and emergency admin to `_e_admin`\r\n    @param _o_admin Ownership admin\r\n    @param _e_admin Emergency admin\r\n    \"\"\"\r\n    assert msg.sender == self.ownership_admin, \"Access denied\"\r\n\r\n    self.future_ownership_admin = _o_admin\r\n    self.future_emergency_admin = _e_admin\r\n\r\n    log CommitAdmins(_o_admin, _e_admin)\r\n\r\n\r\n@external\r\ndef apply_set_admins():\r\n    \"\"\"\r\n    @notice Apply the effects of `commit_set_admins`\r\n    \"\"\"\r\n    assert msg.sender == self.ownership_admin, \"Access denied\"\r\n\r\n    _o_admin: address = self.future_ownership_admin\r\n    _e_admin: address = self.future_emergency_admin\r\n    self.ownership_admin = _o_admin\r\n    self.emergency_admin = _e_admin\r\n\r\n    log ApplyAdmins(_o_admin, _e_admin)","ABI":"[{\"name\":\"CommitAdmins\",\"inputs\":[{\"name\":\"ownership_admin\",\"type\":\"address\",\"indexed\":false},{\"name\":\"emergency_admin\",\"type\":\"address\",\"indexed\":false}],\"anonymous\":false,\"type\":\"event\"},{\"name\":\"ApplyAdmins\",\"inputs\":[{\"name\":\"ownership_admin\",\"type\":\"address\",\"indexed\":false},{\"name\":\"emergency_admin\",\"type\":\"address\",\"indexed\":false}],\"anonymous\":false,\"type\":\"event\"},{\"name\":\"DelegationSet\",\"inputs\":[{\"name\":\"delegation\",\"type\":\"address\",\"indexed\":false}],\"anonymous\":false,\"type\":\"event\"},{\"stateMutability\":\"nonpayable\",\"type\":\"constructor\",\"inputs\":[{\"name\":\"_delegation\",\"type\":\"address\"},{\"name\":\"_o_admin\",\"type\":\"address\"},{\"name\":\"_e_admin\",\"type\":\"address\"}],\"outputs\":[]},{\"stateMutability\":\"view\",\"type\":\"function\",\"name\":\"adjusted_balance_of\",\"inputs\":[{\"name\":\"_account\",\"type\":\"address\"}],\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"gas\":7389},{\"stateMutability\":\"nonpayable\",\"type\":\"function\",\"name\":\"kill_delegation\",\"inputs\":[],\"outputs\":[],\"gas\":26337},{\"stateMutability\":\"nonpayable\",\"type\":\"function\",\"name\":\"set_delegation\",\"inputs\":[{\"name\":\"_delegation\",\"type\":\"address\"}],\"outputs\":[],\"gas\":41322},{\"stateMutability\":\"nonpayable\",\"type\":\"function\",\"name\":\"commit_set_admins\",\"inputs\":[{\"name\":\"_o_admin\",\"type\":\"address\"},{\"name\":\"_e_admin\",\"type\":\"address\"}],\"outputs\":[],\"gas\":74708},{\"stateMutability\":\"nonpayable\",\"type\":\"function\",\"name\":\"apply_set_admins\",\"inputs\":[],\"outputs\":[],\"gas\":78756},{\"stateMutability\":\"view\",\"type\":\"function\",\"name\":\"delegation\",\"inputs\":[],\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"gas\":2538},{\"stateMutability\":\"view\",\"type\":\"function\",\"name\":\"emergency_admin\",\"inputs\":[],\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"gas\":2568},{\"stateMutability\":\"view\",\"type\":\"function\",\"name\":\"ownership_admin\",\"inputs\":[],\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"gas\":2598},{\"stateMutability\":\"view\",\"type\":\"function\",\"name\":\"future_emergency_admin\",\"inputs\":[],\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"gas\":2628},{\"stateMutability\":\"view\",\"type\":\"function\",\"name\":\"future_ownership_admin\",\"inputs\":[],\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"gas\":2658}]","ContractName":"Vyper_contract","CompilerVersion":"vyper:0.2.15","OptimizationUsed":0,"Runs":0,"ConstructorArguments":"0x000000000000000000000000c620aafd6caa3cb7566e54176dd2ed1a81d056550000000000000000000000007eeac6cddbd1d0b8af061742d41877d7f707289a0000000000000000000000007eeac6cddbd1d0b8af061742d41877d7f707289a","EVMVersion":"Default","Library":"","LicenseType":"MIT","Proxy":0,"SwarmSource":""}]}